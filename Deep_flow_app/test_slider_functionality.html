<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Test Slider Functionality</title>
    <link rel="stylesheet" href="/static/css/energy-insights.css">
    <style>
        body {
            font-family: Arial, sans-serif;
            padding: 20px;
            background: #f5f5f5;
        }
        .test-container {
            max-width: 600px;
            margin: 0 auto;
            background: white;
            padding: 30px;
            border-radius: 10px;
            box-shadow: 0 2px 10px rgba(0,0,0,0.1);
        }
        .debug-info {
            background: #f0f0f0;
            padding: 15px;
            margin-top: 20px;
            border-radius: 5px;
            font-family: monospace;
        }
    </style>
</head>
<body>
    <div class="test-container">
        <h1>Slider Functionality Test</h1>
        
        <form id="add-energy-insight-form">
            <div class="energy-insights-form-layout">
                <!-- Row 1: Energy and Focus Levels -->
                <div class="form-row">
                    <div class="form-group half-width">
                        <label for="energy-level">
                            <i class="fas fa-battery-three-quarters"></i> Energy Level
                        </label>
                        <div class="slider-container">
                            <input type="range" id="energy-level" name="energy_level" min="1" max="10" value="5" class="energy-slider">
                            <div class="slider-labels">
                                <span>Low</span>
                                <span class="energy-value">5</span>
                                <span>High</span>
                            </div>
                        </div>
                    </div>
                    
                    <div class="form-group half-width">
                        <label for="focus-level">
                            <i class="fas fa-bullseye"></i> Focus Level
                        </label>
                        <div class="slider-container">
                            <input type="range" id="focus-level" name="focus_level" min="1" max="10" value="5" class="energy-slider">
                            <div class="slider-labels">
                                <span>Scattered</span>
                                <span class="energy-value">5</span>
                                <span>Sharp</span>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </form>
        
        <div class="debug-info">
            <h3>Debug Information:</h3>
            <div id="debug-output"></div>
        </div>
    </div>

    <script>
        // Test the exact same logic as in the main application
        function initializeEnergyInsightsForm() {
            const form = document.getElementById('add-energy-insight-form');
            if (!form) {
                console.error('Form not found!');
                return;
            }
            
            console.log('Form found:', form);
            
            // Handle slider value updates
            const sliders = form.querySelectorAll('.energy-slider');
            console.log('Found sliders:', sliders.length);
            
            sliders.forEach((slider, index) => {
                console.log(`Processing slider ${index}:`, slider);
                
                // Find the correct value span - it's in the slider-labels div
                const sliderContainer = slider.closest('.slider-container');
                console.log(`Slider container ${index}:`, sliderContainer);
                
                const valueSpan = sliderContainer ? sliderContainer.querySelector('.energy-value') : null;
                console.log(`Value span ${index}:`, valueSpan);
                
                if (valueSpan) {
                    // Set initial value
                    valueSpan.textContent = slider.value;
                    console.log(`Set initial value for slider ${index}: ${slider.value}`);
                    
                    // Update on input
                    slider.addEventListener('input', function() {
                        valueSpan.textContent = this.value;
                        console.log(`Updated slider ${index} value to: ${this.value}`);
                        
                        // Update debug display
                        document.getElementById('debug-output').innerHTML = `
                            <p>Energy Level: ${document.getElementById('energy-level').value}/10</p>
                            <p>Focus Level: ${document.getElementById('focus-level').value}/10</p>
                            <p>Last updated: ${new Date().toLocaleTimeString()}</p>
                        `;
                    });
                } else {
                    console.error(`No value span found for slider ${index}`);
                }
            });
        }
        
        // Initialize when page loads
        document.addEventListener('DOMContentLoaded', function() {
            console.log('DOM loaded, initializing sliders...');
            initializeEnergyInsightsForm();
            
            // Initial debug display
            document.getElementById('debug-output').innerHTML = `
                <p>Energy Level: 5/10</p>
                <p>Focus Level: 5/10</p>
                <p>Initialized at: ${new Date().toLocaleTimeString()}</p>
            `;
        });
    </script>
</body>
</html>
